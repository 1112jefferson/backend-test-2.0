# Nombre Proyecto: Google App Engine (GAE) Python Clean Architecture

### Descripci√≥n

Plantilla base de un App Engine escrito con Python utilizando Flask, SQL Alchemy, tratando de seguir las convenciones de Clean Architecture.

En este ejemplo, la aplicaci√≥n contiene dos secciones: una llamada "greeting", que es simplemente un endpoint que retorna un saludo indicando el n√∫mero del visitante, el cual se obtiene desde un cach√©, y la otra es "books", que consiste en un CRUD de libros, los cuales son guardados en una base de datos, ya sea en MySQL o en Firestore.

Al ser un proyecto en Python, se siguen las siguientes convenciones:

- Identaci√≥n de cuatro espacios (no tabulaci√≥n), incluso en archivos que no son `.py`.
- Nombres de clases en `UpperCamelCase`.
- M√©todos, funciones y variables en `snake_case`.
- Nombres de m√≥dulos (archivos `.py`) en `snake_case`.
- Nombres de paquetes (carpetas) en `lowercase`, sin guiones bajos incluso si contienen m√°s de una palabra (por ejemplo, "usecases" en vez de "use_cases").
- Usar importaciones absolutas dentro de lo posible.

### Construcci√≥n üõ†Ô∏è
* **Lenguaje:** Python 3
* **Framework:** Flask, SQL Alchemy

### Pre-requisitos üìã

- Docker.

### Instalaci√≥n üîß

- Clonar proyecto.
- Crear archivo `.env` en la carpeta ra√≠z. Se incluye archivo `.env.example` como referencia, que se puede usar tal cual como est√°.
- Ejecutar `docker-compose build` para construir las im√°genes de Docker. S√≥lo es necesario hacerlo una vez.
- Ejecutar `docker-compose up` para levantar los servicios. Es probable que la primera vez la aplicaci√≥n Flask arroje excepci√≥n, debido a que tratar√° de conectarse con el servicio MySQL que a√∫n est√° inicializ√°ndose por primera vez; en este caso esperar a que MySQL se inicialice completamente primero y luego ejecutar el comando `docker-compose restart $NAME_SERVICE` en otro terminal para reiniciar el servicio ca√≠do.

### Despliegue üì¶


### Pruebas ‚öôÔ∏è

Para ejecutar pruebas manuales se incluye el archivo `req.http` con las solicitudes a localhost. Instalar `REST Client` para Visual Studio Code o `RESTer HTTP Client` para Sublime Text para poder realizar las solicitudes del archivo desde el mismo editor de texto.

Para ejecutar los tests:

- Tener los servicios corriendo usando `docker-compose up`.
- En otra consola, ejecutar `docker-compose exec gae-service python -m pytest -rP`.

La bandera `-rP` es opcional, y sirve para mostrar en consola los `print()` hechos durante las pruebas, de lo contrario `pytest` los ocultar√°, s√≥lo mostr√°ndolos en caso de que la prueba haya fallado.

Los tests de los repositorios escriben datos en las bases de datos de los contenedores, pero los escriben en tablas o colecciones temporales con el sufijo "\_test" que se eliminan una vez finalizados, para as√≠ no pasar a llevar los datos reales. Tener en cuenta que para el caso de Firestore no hay persistencia de datos a√∫n; si el servicio se baja y se levanta de nuevo, los datos anteriores se pierden.

### Autores ‚úíÔ∏è

* **Autor:** Hans Auzian C., hans.auzian@enviame.io